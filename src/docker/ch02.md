## 도커의 동작 원리

### 도커의 구조

일반적으로 `도커`와 `컨테이너`는 서버에서 사용된다.

우선 물리 서버가 있고, 물리 서버에서 동작하는 리눅스 운영체제가 있다. 여기까지는 일반적인 서버와 다를 바 없다.

일반적인 서버라면 운영체제 위에 프로그램이나 데이터가 직접 올라가겠지만

도커를 사용하는 경우에는 **운영체제 위에 도커 엔진이 동작하고 그 위에서 컨테이너가 동작**한다.

![img.png](image/docker.png)

### 컨테이너 안에는 운영체제 비슷한 것이 들어있다.

**모든 컨테이너에는 리눅스 운영체제 비슷한 무언가가 들어있다**.

`빈 컨테이너`라고 했지만 정말로 텅 빈 것은 아니다.

여기서 말하는 `리눅스 운영체제 비슷한 무언가`는 무엇을 의미할까?


### 운영체제가 하는 일

`운영체제`는 **소프트웨어나 프로그램의 명령을 하드웨어에 전달하는 역할**을 한다.

`하드웨어`는 자신의 판단으로 여러 의미 중 적절한 것을 고르거나 적당히 일을 할 수 없고,

지시받은 대로만 수행할 수 있기 때문에 **세세한 동작 하나하나를 지정해주지 않으면 안된다**.

그렇기 때문에 `운영체제`가 명령을 번역해 `하드웨어`에 전달한다.

<br>

위에서 말했던 것 처럼 **도커 엔진 아래에도 리눅스 운영체제가 있는데, 컨테이너 속에 또 리눅스 운영체제(비슷한 것)가 있다**고 했다.

기묘한 구조지만 이는 도커의 가장 큰 특징 중 하나다.

본래 `운영체제`는 `커널`이라는 부분과 `그 외의 주변 부분`으로 구성된다.

`주변 부분`이 **프로그램의 연락 내용을 커널에 전달**하고 `커널`이 **하드웨어를 다룬다**.

> 주변 부분은 프로그램에서 명령을 전달받거나 커널이 실행한 결과를 프로그램에 다시 전달하는 역할을 한다.
> 키보드로 입력한 내용을 전달받고 모니터에 데이터를 출력하는 것이 이러한 예다.

`도커`는 컨테이너가 **완전히 분리**되어 있으므로 **밑바탕이 되는 리눅스 운영체제의 주변 부분**이 컨테이너 속 프로그램의 명령을 전달받을 수 없다.

따라서 컨테이너 속에 **운영체제의 주변 부분**이 들어있어 프로그램의 명령을 전달받고 이를 밑바탕이 되는 커널에 전달하는 구조로 돼 있다.

위에서 말한 `컨테이너` 속 **운영체제 비슷한 것**이 들어 있는 것은 이 때문이다. 전체 리눅스 운영체제가 들어있는 것이 아니라 **주변 부분**만 들어 있기 때문에 `비슷한 것`이라고 표한하는 것이다.

이러한 형태 덕분에 **도커의 가장 큰 특징**인 `가벼움`을 얻을 수 있다.

### 도커는 기본적으로 리눅스용이다.

`도커`는 기본적으로 **리눅스 운영체제**에서만 동작한다.

도커는 밑바탕에서 **리눅스 운영체제가 동작하는 것을 전제**로 하는 구조로 돼 있기 떄문에 리눅스 운영체제에서만 동작할 수있다.

또 컨테이너 안에 있는 **주변 부분**도 이에 맞게 **리눅스 운영체제의 주변 부분**이어야 한다.

컨테이너에서 실행할 소프트웨어(프로그램) 역시 리눅스용 소프트웨어다. 윈도우/mac OS용 소프트웨어는 컨테이너에 넣어도 동작하지 않는다.

즉, 도커는 리눅스 컴퓨터에 독립된 격리 환경을 만드는 것이며, 리눅스에서만 동작하고, 컨테이너에서 동작할 프로그램도 리눅스용 프로그램이다.



